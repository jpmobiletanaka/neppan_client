#!/bin/bash

# Development helper script for neppan_client gem

case "$1" in
  setup)
    echo "Setting up development environment..."
    docker-compose build
    docker-compose run --rm gem bundle install
    ;;
  test)
    echo "Running tests..."
    docker-compose run --rm gem bundle exec rspec
    ;;
  console)
    echo "Starting console..."
    docker-compose run --rm gem bundle exec bin/console
    ;;
  lint)
    echo "Running rubocop..."
    docker-compose run --rm gem bundle exec rubocop
    ;;
  shell)
    echo "Starting shell in container..."
    docker-compose run --rm gem sh
    ;;
  build)
    echo "Building gem..."
    docker-compose run --rm gem gem build neppan_client.gemspec
    ;;
  clean)
    echo "Cleaning up..."
    docker-compose down -v
    docker system prune -f
    ;;
  *)
    echo "Usage: $0 {setup|test|console|lint|shell|build|clean}"
    echo ""
    echo "Commands:"
    echo "  setup   - Build Docker image and install dependencies"
    echo "  test    - Run RSpec tests"
    echo "  console - Start interactive console"
    echo "  lint    - Run RuboCop linter"
    echo "  shell   - Start shell in container"
    echo "  build   - Build gem package"
    echo "  clean   - Clean up Docker containers and images"
    exit 1
    ;;
esac
